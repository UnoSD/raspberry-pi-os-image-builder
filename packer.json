{
  "variables": {
    "image_url": null,
    "image_checksum": null,
    "wifi_ssid": "",
    "wifi_password": "",
    "ip": null,
    "subnet": null,
    "router": null,
    "ssh_public_key_path": null,
    "username": null
  },
  "sensitive-variables": [ "wifi_password" ],
  "builders": [
    {
      "type": "arm-image",
      "iso_url": "{{user `image_url`}}",
      "iso_checksum": "{{user `image_checksum`}}"
    }
  ],
  "provisioners": [
    {
      "type": "shell",
      "environment_vars": [ 
        "USERNAME={{user `username`}}",
        "IP={{user `ip`}}",
        "SUBNET={{user `subnet`}}",
        "ROUTER={{user `router`}}",
        "SSID={{user `wifi_ssid`}}",
        "WIFI_PASSWORD={{user `wifi_password`}}"
     ],
      "script": "./setup.sh"
    },
    {
      "type": "file",
      "source": "{{user `ssh_public_key_path`}}",
      "destination": "/home/{{user `username`}}/.ssh/authorized_keys"
    }
  ]
}
